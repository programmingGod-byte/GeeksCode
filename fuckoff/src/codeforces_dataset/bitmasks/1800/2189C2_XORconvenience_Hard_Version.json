{
    "contestId": 2189,
    "index": "C2",
    "title": "C2. XOR-convenience (Hard Version)",
    "statement": "This is the\nhard\nversion of the problem. The difference between the versions is that in this version, $$$1 \\le i \\le n-1$$$. Note that a correct solution for the\nhard\nversion is not necessarily a correct solution for the\neasy\nversion.\nGiven a positive integer $$$n$$$. Find some permutation$$$^{\\text{∗}}$$$ $$$p$$$ of length $$$n$$$ such that for every $$$i$$$ ($$$\\style{color:red}{1 \\le i \\le n-1}$$$) there exists $$$j$$$ ($$$\\style{color:red}{i \\le j \\le n}$$$) such that $$$p_i = p_j \\oplus i$$$ $$$^{\\text{†}}$$$, or determine that it does not exist.\n$$$^{\\text{∗}}$$$A permutation of length $$$n$$$ is an array consisting of $$$n$$$ distinct integers from $$$1$$$ to $$$n$$$ in arbitrary order. For example, $$$[2,3,1,5,4]$$$ is a permutation, but $$$[1,2,2]$$$ is not a permutation ($$$2$$$ appears twice in the array), and $$$[1,3,4]$$$ is also not a permutation ($$$n=3$$$ but there is $$$4$$$ in the array).\n$$$^{\\text{†}}$$$$$$\\oplus$$$ denotes the\nbitwise XOR operation\n.",
    "inputSpecification": "Input\nEach test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\le t \\le 10^4$$$). The description of the test cases follows.\nThe only line of each test case contains one positive integer $$$n$$$ ($$$3 \\leq n \\leq 2 \\cdot 10^5$$$) — the length of the permutation.\nIt is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$2\\cdot 10^5$$$.",
    "outputSpecification": "Output\nFor each test case, if there is a suitable permutation, output $$$n$$$ integers $$$p_1,p_2,\\ldots,p_n$$$ — the permutation $$$p$$$. Otherwise, output $$$-1$$$.\nIf multiple solutions exist, output any of them.",
    "note": "Note\nIn the first test case, the permutation $$$p = [2,1,3]$$$ fulfills the condition, as $$$p_2 = 1$$$ and $$$p_3 \\oplus 2 = 1$$$.\nIn the second test case, there is no suitable permutation.",
    "tags": [
        "bitmasks",
        "constructive algorithms",
        "math"
    ],
    "rating": 1800
}