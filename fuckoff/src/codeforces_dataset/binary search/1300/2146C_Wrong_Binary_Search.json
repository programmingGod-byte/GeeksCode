{
    "contestId": 2146,
    "index": "C",
    "title": "C. Wrong Binary Search",
    "statement": "You are given an integer $$$n$$$ and a binary string$$$^{\\text{∗}}$$$ $$$s$$$ of length $$$n$$$.\nFor a permutation$$$^{\\text{†}}$$$ $$$p$$$ of length $$$n$$$ and an integer $$$x$$$, we define $$$\\text{find}(x)$$$ as in the following pseudocode:\nfunction find(int x):\nl := 1\nr := n\nwhile l <= r:\nlet m be a random integer between l and r (inclusive)\nif p[m] == x\nreturn m\nif p[m] > x:\nr := m - 1\nelse:\nl := m + 1\nreturn undefined     // not found\nWe call an integer $$$x$$$ ($$$1\\le x\\le n$$$)\nstable\nif and only if $$$\\text{find}(x)$$$ is\nalways\nnot undefined and $$$p_{\\text{find}(x)}=x$$$\nalways\nholds, no matter how the value of $$$m$$$ is selected in the process of the pseudocode.\nYou have to construct a permutation $$$p$$$ of length $$$n$$$, such that:\nFor each $$$1\\le i\\le n$$$, the integer $$$i$$$ is\nstable\nif and only if\n$$$s_i=\\mathtt{1}$$$.\nOr determine that no such permutation exists.\n$$$^{\\text{∗}}$$$A binary string is a string where each character is either $$$\\mathtt{0}$$$ or $$$\\mathtt{1}$$$.\n$$$^{\\text{†}}$$$A permutation of length $$$n$$$ is an array consisting of $$$n$$$ distinct integers from $$$1$$$ to $$$n$$$ in arbitrary order. For example, $$$[2,3,1,5,4]$$$ is a permutation, but $$$[1,2,2]$$$ is not a permutation ($$$2$$$ appears twice in the array), and $$$[1,3,4]$$$ is also not a permutation ($$$n=3$$$ but there is $$$4$$$ in the array).",
    "inputSpecification": "Input\nEach test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\le t \\le 10^4$$$). The description of the test cases follows.\nThe first line of each test case contains a single integer $$$n$$$ ($$$2\\le n \\le 2\\cdot 10^5$$$) — the length of the permutation.\nThe second line contains the binary string $$$s$$$ of length $$$n$$$ ($$$s_i=\\mathtt{0}$$$ or $$$\\mathtt{1}$$$).\nIt is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$2\\cdot 10^5$$$.",
    "outputSpecification": "Output\nFor each test case:\nIf no such permutation exists, print \"\nNO\n\" in the only line of output.\nOtherwise, print \"\nYES\n\" in the first line of output. Then output $$$n$$$ distinct integers $$$p_1, p_2, \\ldots, p_n$$$ ($$$1\\le p_i\\le n$$$) in the second line — the permutation you constructed.\nYou can output the token in any case (upper or lower). For example, the strings \"\nyEs\n\", \"\nyes\n\", \"\nYes\n\", and \"\nYES\n\" will be recognized as positive responses.\nIf there are multiple answers, you may print any of them.",
    "note": "Note\nIn the first test case, we have constructed $$$p=[1,2,3]$$$. Take $$$\\text{find(2)}$$$ as an example:\nIn the beginning, $$$l=1$$$ and $$$r=3$$$;\nWe will select $$$m$$$ as a random integer between $$$l=1$$$ and $$$r=3$$$.\nIf we choose $$$m=1$$$:\n$$$p_1=1< 2$$$, so $$$l$$$ is set to $$$m + 1 = 2$$$. Now $$$l=2$$$ and $$$r=3$$$;\nWe will select $$$m$$$ as a random integer between $$$l=2$$$ and $$$r=3$$$.\nIf we choose $$$m=2$$$: $$$p_2=2$$$, so the return value is $$$2$$$.\nIf we choose $$$m=3$$$: $$$p_3=3>2$$$, so $$$r$$$ is set to $$$m-1=2$$$. Now $$$l=2$$$ and $$$r=2$$$, so we can only select $$$m=2$$$. $$$p_2=2$$$, so the return value is $$$2$$$.\nIf we choose $$$m=2$$$:\n$$$p_2=2$$$, so the return value is $$$2$$$.\nIf we choose $$$m=3$$$, the process is similar to that when $$$m=1$$$ is chosen. The return value is always $$$2$$$.\nThus, no matter how $$$m$$$ is selected during the process, the return value of $$$\\text{find}(2)$$$ is always $$$2$$$.\nSo $$$p_{\\text{find}(2)}= p_2 = 2$$$ always holds, and the integer $$$2$$$ is\nstable\n.\nSimilarly, we can show that integers $$$1$$$ and $$$3$$$ are also\nstable\n. Thus, the permutation $$$p = [1, 2, 3]$$$ is a valid answer.\nIn the second test case, we have constructed $$$p=[2,4,3,5,1]$$$. Take $$$\\text{find(3)}$$$ as an example:\nIn the beginning, $$$l=1$$$ and $$$r=5$$$;\nWe will select $$$m$$$ as a random integer between $$$l=1$$$ and $$$r=5$$$. Let's choose $$$m=2$$$;\n$$$p_2=4>3$$$, so $$$r$$$ is set to $$$m-1=1$$$. Now $$$l=1$$$ and $$$r=1$$$;\nWe will select $$$m$$$ as a random integer between $$$l=1$$$ and $$$r=1$$$. We can only choose $$$m=1$$$;\n$$$p_1=2<3$$$, so $$$l$$$ is set to $$$m + 1 = 2$$$. Now $$$l=2$$$ and $$$r=1$$$;\nSince $$$l>r$$$, the loop is exited and the return value is undefined.\nThus, the return value of $$$\\text{find}(3)$$$ is undefined, so the integer $$$3$$$ is not\nstable\n.\nSimilarly, we can show that integers $$$1$$$, $$$2$$$, $$$4$$$, and $$$5$$$ are also not\nstable\n. Thus, $$$p = [2, 4, 3, 5, 1]$$$ is a valid answer.\nSome other permutations, such as $$$p=[5,4,3,2,1]$$$ and $$$p=[3,5,1,4,2]$$$, are also valid answers. You may print any of them.\nIn the third test case, it can be proven that no such permutation exists.",
    "tags": [
        "binary search",
        "constructive algorithms"
    ],
    "rating": 1300
}