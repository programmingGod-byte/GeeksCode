{
    "contestId": 2190,
    "index": "C",
    "title": "C. Comparable Permutations",
    "statement": "This is an interactive problem.\nFor a permutation$$$^{\\text{∗}}$$$ $$$g = (g_1, g_2, \\ldots, g_m)$$$, define its reverse as $$$\\operatorname{rev}(g) = (g_m, g_{m-1}, \\ldots, g_1)$$$.\nThere is a hidden permutation $$$p$$$ of size $$$n$$$. Your task is to find the lexicographically smallest$$$^{\\text{†}}$$$ permutation $$$q$$$ of size $$$n$$$ such that $$$q  \\gt  p$$$ and $$$\\operatorname{rev}(q)  \\gt  \\operatorname{rev}(p)$$$.\nHowever, you do not need to output $$$q$$$ itself. Instead, you must output a permutation $$$r$$$ of size $$$n$$$ such that $$$q_i = p_{r_i}$$$ for all $$$1 \\le i \\le n$$$. If no such $$$q$$$ exists, report that instead.\nTo find the answer, you can ask at most $$$3n$$$ queries of the form $$$\\texttt{? } i \\; j$$$ ($$$1 \\le i, j \\le n$$$). The interactor responds with $$$1$$$ if $$$p_i  \\lt  p_j$$$ and $$$0$$$ otherwise. The interactor is\nnot adaptive\n, which means that the permutation $$$p$$$ is fixed throughout the interaction.\n$$$^{\\text{∗}}$$$A permutation of length $$$n$$$ is an array consisting of $$$n$$$ distinct integers from $$$1$$$ to $$$n$$$ in arbitrary order. For example, $$$[2,3,1,5,4]$$$ is a permutation, but $$$[1,2,2]$$$ is not a permutation ($$$2$$$ appears twice in the array), and $$$[1,3,4]$$$ is also not a permutation ($$$n=3$$$ but there is $$$4$$$ in the array).\n$$$^{\\text{†}}$$$ An array $$$x$$$ is lexicographically\nsmaller\nthan array $$$y$$$ (so $$$x  \\lt  y$$$) if and only if one of the following holds:\n$$$x$$$ is a prefix of $$$y$$$, but $$$x \\ne y$$$; or\nLet $$$i$$$ be the first position where $$$x_i \\neq y_i$$$ (if it exists), then $$$x_i  \\lt  y_i$$$.",
    "inputSpecification": "Input\nEach test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\le t \\le 1000$$$). The description of the test cases follows.\nThe first line of each test case contains a single integer $$$n$$$ ($$$2 \\le n \\le 2 \\cdot 10^4$$$) — the size of the hidden permutation $$$p$$$.\nThe hidden permutation $$$p$$$ is fixed for the test case and does not change during the interaction. In other words, the interactor is\nnot adaptive\n.\nIt is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$2 \\cdot 10^4$$$.",
    "outputSpecification": "",
    "note": "Note\nIn the example, the interaction proceeds as follows.\nSolution\nJury\nExplanation\n3\nThere are $$$3$$$ test cases.\n5\nIn the first test case, the hidden permutation is $$$[5, 4, 2, 3, 1]$$$, with length $$$5$$$. The corresponding permutation $$$q = [5, 4, 3, 1, 2]$$$\n? 2 1\n1\nThe solution asks whether $$$p_2 \\lt p_1$$$, and the jury responds with $$$1$$$, as $$$4 \\lt 5$$$.\n! 1 2 4 5 3\nThe solution has miraculously determined the answer and prints $$$r = [1, 2, 4, 5, 3]$$$, because, for instance, $$$q_3 = p_{r_3} = p_4 = 3$$$ and $$$q_2 = p_{r_2} = p_2 = 4$$$.\n4\nIn the second test case, the hidden permutation is $$$[3, 1, 2, 4]$$$, with length $$$4$$$. The permutation $$$q$$$ does not exist for that case.\n? 2 3\n1\nThe solution asks whether $$$p_2 \\lt p_3$$$, and the jury responds with $$$1$$$.\n? 1 3\n0\nThe solution asks whether $$$p_1 \\lt p_3$$$, and the jury responds with $$$0$$$.\n? 1 4\n1\nThe solution asks whether $$$p_1 \\lt p_4$$$, and the jury responds with $$$1$$$.\n? 2 2\n0\nThe solution asks whether $$$p_2 \\lt p_2$$$, and the jury responds with $$$0$$$.\n! -1\nThe solution now knows that $$$p = [3, 1, 2, 4]$$$ and determines that the corresponding $$$q$$$ does not exist, so it prints $$$-1$$$.\n9\nIn the third test case, $$$p = [8, 1, 9, 3, 5, 4, 2, 6, 7]$$$, with length $$$n = 9$$$.\n! 1 2 3 6 7 4 5 8 9\nThe solution decides to guess the answer and outputs $$$r = [1, 2, 3, 6, 7, 4, 5, 8, 9]$$$, which turns out to be correct.\nNote that the empty lines in the example input and output are for the sake of clarity and do not occur in the real interaction.",
    "tags": [
        "greedy",
        "implementation",
        "interactive",
        "sortings",
        "two pointers"
    ],
    "rating": 2300
}